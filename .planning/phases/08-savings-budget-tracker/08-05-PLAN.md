---
phase: 08-savings-budget-tracker
plan: 05
type: execute
wave: 4
depends_on: ["08-01", "08-02", "08-03"]
files_modified:
  - src/components/budget/AnnualSpendForecast.tsx
  - src/app/(app)/budget/page.tsx
autonomous: true
must_haves:
  truths:
    - "Annual spend forecast shows upcoming hunt costs grouped by year"
    - "Each year shows itemized costs per hunt goal with state and species"
    - "Total cost per year is clearly visible"
    - "Forecast appears on the budget page"
  artifacts:
    - path: "src/components/budget/AnnualSpendForecast.tsx"
      provides: "Annual spend forecast visualization component"
      contains: "AnnualSpendForecast"
    - path: "src/app/(app)/budget/page.tsx"
      provides: "Budget page with annual forecast section"
      contains: "AnnualSpendForecast"
  key_links:
    - from: "src/components/budget/AnnualSpendForecast.tsx"
      to: "src/lib/engine/savings-calculator.ts"
      via: "calculateAnnualSpendForecast"
      pattern: "import.*calculateAnnualSpendForecast"
    - from: "src/app/(app)/budget/page.tsx"
      to: "src/components/budget/AnnualSpendForecast.tsx"
      via: "component import"
      pattern: "import.*AnnualSpendForecast"
---

<objective>
Create the annual spend forecast component and add it to the budget page.

Purpose: SAV-07 requires an annual spend forecast summarizing all upcoming hunt costs. This gives users a year-by-year view of their financial commitments, showing exactly how much each hunt costs and when the money is needed.

Output: AnnualSpendForecast component and its integration on the budget page.
</objective>

<execution_context>
@/Users/mattramirez/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mattramirez/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-savings-budget-tracker/08-RESEARCH.md
@.planning/phases/08-savings-budget-tracker/08-01-SUMMARY.md
@.planning/phases/08-savings-budget-tracker/08-02-SUMMARY.md
@src/app/(app)/budget/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create AnnualSpendForecast component</name>
  <files>src/components/budget/AnnualSpendForecast.tsx</files>
  <action>
Create src/components/budget/AnnualSpendForecast.tsx as a "use client" component.

Imports:
```typescript
import { useMemo } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { CalendarDays } from "lucide-react";
import { useAppStore } from "@/lib/store";
import { calculateAnnualSpendForecast } from "@/lib/engine/savings-calculator";
import { STATES_MAP } from "@/lib/constants/states";
import { formatSpeciesName } from "@/lib/utils";
import { SpeciesAvatar } from "@/components/shared/SpeciesAvatar";
import { AnimatedCounter } from "@/components/shared/AnimatedCounter";
```

Component logic:
1. Read `userGoals` and `milestones` from useAppStore.
2. useMemo to compute forecast: `calculateAnnualSpendForecast(userGoals, milestones, 5)`.
3. Filter out years with totalCost === 0 (no action years).
4. If no years have costs, return null (don't render empty section).

Render layout:
```
[Card with header "Annual Spend Forecast" + CalendarDays icon]
  [For each year with costs:]
    [Year header: "2027" with total cost right-aligned]
    [Grid of cost items:]
      [SpeciesAvatar + "CO Elk" | "$2,400"]
      [SpeciesAvatar + "WY Mule Deer" | "$1,800"]
    [Divider between years]
```

Specific layout details:
- Card header: `<CalendarDays className="w-5 h-5 text-primary" />` + "Annual Spend Forecast"
- Each year: sticky year label on left, `<AnimatedCounter>` total on right, items below
- Each item row: SpeciesAvatar (size 24), state abbreviation badge (7x7 rounded, state.color bg), species name, cost right-aligned
- Year total bar: subtle gradient background `bg-gradient-to-r from-primary/5 to-transparent` with year and total
- Use `text-muted-foreground` for secondary labels, `font-bold` for totals
- Mobile: stack items vertically. Desktop: 2-column grid for items within each year.

Handle edge case: if `calculateAnnualSpendForecast` returns empty or all-zero years, the component returns null.
  </action>
  <verify>Run `npx tsc --noEmit` -- no type errors. Component exports AnnualSpendForecast.</verify>
  <done>AnnualSpendForecast component renders year-by-year cost breakdown with species avatars, state badges, and animated totals.</done>
</task>

<task type="auto">
  <name>Task 2: Add AnnualSpendForecast to budget page</name>
  <files>src/app/(app)/budget/page.tsx</files>
  <action>
In src/app/(app)/budget/page.tsx:

1. Add import:
   ```typescript
   import { AnnualSpendForecast } from "@/components/budget/AnnualSpendForecast";
   ```

2. Add the component AFTER the SavingsGoalsSection and BEFORE the closing `</div>`:
   ```tsx
   {/* Annual Spend Forecast (SAV-07) */}
   <AnnualSpendForecast />
   ```

The component self-gates (returns null if no costs exist), so no conditional wrapper needed. The existing page structure already has:
- AnnualBudgetPlanner
- YearByYearBreakdown
- SavingsGoalsSection
- NEW: AnnualSpendForecast

This is a clean additive change -- one import line and one JSX line.
  </action>
  <verify>Run `npx tsc --noEmit` -- no type errors. Open /budget page -- annual spend forecast section appears below savings goals.</verify>
  <done>Budget page displays annual spend forecast showing upcoming hunt costs grouped by year (SAV-07).</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. AnnualSpendForecast renders year-by-year costs when milestones exist
3. Years with $0 cost are hidden
4. Budget page shows the new section in correct position
5. Component returns null gracefully when no forecast data exists
</verification>

<success_criteria>
- Annual spend forecast visible on budget page with year-by-year cost breakdown (SAV-07)
- Each year shows itemized hunt costs with state and species
- Animated counters for dollar amounts match existing patterns
- No visual regressions to existing budget page sections
</success_criteria>

<output>
After completion, create `.planning/phases/08-savings-budget-tracker/08-05-SUMMARY.md`
</output>
