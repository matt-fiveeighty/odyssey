---
phase: 08-savings-budget-tracker
plan: 03
type: execute
wave: 3
depends_on: ["08-01", "08-02"]
files_modified:
  - src/components/budget/SavingsProgressRing.tsx
  - src/app/(app)/dashboard/page.tsx
autonomous: true
must_haves:
  truths:
    - "Each hunt goal on the dashboard has a savings progress ring showing percent funded"
    - "Traffic light status (green/amber/red) makes it immediately clear which hunts are on track"
    - "Progress ring animates in on mount (no flash of full ring)"
    - "Dashboard shows savings summary only when savingsGoals exist"
  artifacts:
    - path: "src/components/budget/SavingsProgressRing.tsx"
      provides: "SVG circular progress ring with traffic light coloring"
      contains: "SavingsProgressRing"
    - path: "src/app/(app)/dashboard/page.tsx"
      provides: "Savings progress section with rings per goal"
      contains: "SavingsProgressRing"
  key_links:
    - from: "src/app/(app)/dashboard/page.tsx"
      to: "src/lib/engine/savings-calculator.ts"
      via: "deriveTargetCost and calculateSavingsStatus"
      pattern: "import.*savings-calculator"
    - from: "src/app/(app)/dashboard/page.tsx"
      to: "src/components/budget/SavingsProgressRing.tsx"
      via: "component import"
      pattern: "import.*SavingsProgressRing"
---

<objective>
Create the SavingsProgressRing SVG component and integrate savings progress into the dashboard.

Purpose: SAV-01 requires progress rings per hunt goal on the dashboard. SAV-05 requires traffic light coloring. This plan creates the visual layer that shows at-a-glance savings status for each hunt fund.

Output: A reusable SavingsProgressRing component and a new savings section on the dashboard showing rings for each active savings goal with percent funded, dollar amounts, and traffic light coloring.
</objective>

<execution_context>
@/Users/mattramirez/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mattramirez/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-savings-budget-tracker/08-RESEARCH.md
@.planning/phases/08-savings-budget-tracker/08-01-SUMMARY.md
@.planning/phases/08-savings-budget-tracker/08-02-SUMMARY.md
@src/app/(app)/dashboard/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SavingsProgressRing SVG component</name>
  <files>src/components/budget/SavingsProgressRing.tsx</files>
  <action>
Create src/components/budget/SavingsProgressRing.tsx as a "use client" component.

Props interface:
```typescript
interface SavingsProgressRingProps {
  percent: number;          // 0-100
  status: SavingsStatus;    // green/amber/red -> determines stroke color
  size?: number;            // px, default 64
  strokeWidth?: number;     // px, default 4
  children?: React.ReactNode; // Center content (e.g., dollar amount or percent text)
}
```

Implementation:
- SVG with two `<circle>` elements: background track + progress arc
- Background circle: `className="text-secondary"` using `stroke="currentColor"`
- Progress circle: color mapped from SavingsStatus:
  - green -> `"stroke-chart-2"` (matches existing on-track styling in dashboard)
  - amber -> `"stroke-chart-4"` (matches existing warning styling)
  - red -> `"stroke-destructive"` (matches existing critical styling)
- Radius = `(size - strokeWidth) / 2`
- Circumference = `2 * Math.PI * radius`
- Offset = `circumference - (Math.min(percent, 100) / 100) * circumference`
- SVG rotated -90deg so progress starts at top (12 o'clock)
- `strokeLinecap="round"` for polished arc ends
- Progress ring uses inline style for `strokeDasharray` and `strokeDashoffset` with `transition: "stroke-dashoffset 0.5s ease-out"` for animation on mount
- Children rendered in an absolute-positioned overlay centered within the ring
- Clamp percent to 0-100 using `Math.min(100, Math.max(0, percent))`

This is ~40 lines of code. No external dependencies. Follow the exact pattern from the research SVG example.
  </action>
  <verify>Run `npx tsc --noEmit` -- no type errors. The component file exists and exports SavingsProgressRing.</verify>
  <done>SavingsProgressRing component renders SVG circular progress with traffic light coloring and smooth animation.</done>
</task>

<task type="auto">
  <name>Task 2: Add savings progress section to dashboard</name>
  <files>src/app/(app)/dashboard/page.tsx</files>
  <action>
Add a savings progress section to the dashboard page, positioned AFTER the Advisor Insights section and BEFORE the Strategic Metrics section.

1. Add imports at top:
   ```typescript
   import { SavingsProgressRing } from "@/components/budget/SavingsProgressRing";
   import { deriveTargetCost, calculateSavingsStatus } from "@/lib/engine/savings-calculator";
   import { PiggyBank } from "lucide-react";
   ```

2. Pull savingsGoals from useAppStore (add to existing destructure):
   ```typescript
   const { milestones, confirmedAssessment, userPoints, userGoals, lastVisitAt, recordVisit, savingsGoals } = useAppStore();
   ```

3. Add a useMemo that derives savings summaries (only when savingsGoals exist):
   ```typescript
   const savingsSummary = useMemo(() => {
     if (savingsGoals.length === 0) return [];
     return savingsGoals.map((sg) => {
       const goal = userGoals.find((g) => g.id === sg.goalId);
       const targetCost = deriveTargetCost(milestones, sg.goalId);
       const pct = targetCost > 0 ? Math.min(100, (sg.currentSaved / targetCost) * 100) : 0;
       const targetDate = new Date(`${goal?.targetYear ?? 2030}-09-01`);
       const status = calculateSavingsStatus(targetCost, sg.currentSaved, sg.monthlySavings, targetDate);
       return { ...sg, goal, targetCost, pct, status };
     }).filter(s => s.goal); // Only show savings goals with valid linked goals
   }, [savingsGoals, userGoals, milestones]);
   ```

4. Render a savings section (only when hasPlan and savingsSummary has items):
   ```tsx
   {hasPlan && savingsSummary.length > 0 && (
     <Card className="bg-card border-border overflow-hidden">
       <div className="h-1 bg-gradient-to-r from-chart-2 to-chart-4" />
       <CardContent className="p-4">
         <div className="flex items-center justify-between mb-3">
           <div className="flex items-center gap-2">
             <PiggyBank className="w-4 h-4 text-chart-2" />
             <p className="text-sm font-semibold">Hunt Fund Savings</p>
           </div>
           <Link href="/budget" className="text-xs text-muted-foreground hover:text-primary transition-colors">
             Manage
           </Link>
         </div>
         <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
           {savingsSummary.map((s) => (
             <div key={s.id} className="flex items-center gap-3">
               <SavingsProgressRing percent={s.pct} status={s.status} size={56}>
                 <span className="text-[10px] font-bold">{Math.round(s.pct)}%</span>
               </SavingsProgressRing>
               <div className="min-w-0">
                 <p className="text-sm font-medium truncate">{s.goal?.title}</p>
                 <p className="text-xs text-muted-foreground">
                   ${s.currentSaved.toLocaleString()} / ${s.targetCost.toLocaleString()}
                 </p>
                 <p className={`text-[10px] font-medium ${s.status === "green" ? "text-chart-2" : s.status === "amber" ? "text-chart-4" : "text-destructive"}`}>
                   {s.status === "green" ? "On track" : s.status === "amber" ? "Slightly behind" : "Behind"}
                 </p>
               </div>
             </div>
           ))}
         </div>
       </CardContent>
     </Card>
   )}
   ```

5. Add PiggyBank to the existing lucide-react import statement at the top of the file.

The section only renders when savings goals exist. No changes to the no-plan state. The "Manage" link goes to /budget where the full SavingsGoalCard editor lives.
  </action>
  <verify>Run `npx tsc --noEmit` -- no type errors. Open the dashboard in browser -- if savings goals exist, progress rings appear with correct traffic light colors.</verify>
  <done>Dashboard shows savings progress rings per goal with percent funded, dollar amounts, and green/amber/red traffic light status. Section only appears when savings goals exist.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes
2. SavingsProgressRing renders correct color for each status (green -> chart-2, amber -> chart-4, red -> destructive)
3. Dashboard savings section only appears when hasPlan && savingsSummary.length > 0
4. Progress ring animates on mount (stroke-dashoffset transition)
</verification>

<success_criteria>
- Progress rings visible on dashboard per savings goal (SAV-01)
- Traffic light coloring immediately communicates on-track/behind status (SAV-05)
- Clean integration with existing dashboard layout
- No visual regressions to other dashboard sections
</success_criteria>

<output>
After completion, create `.planning/phases/08-savings-budget-tracker/08-03-SUMMARY.md`
</output>
